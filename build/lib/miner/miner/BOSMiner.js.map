{
  "version": 3,
  "sources": ["../../../../src/lib/miner/miner/BOSMiner.ts"],
  "sourcesContent": ["import { PollingMiner } from './PollingMiner';\nimport type { BOSMinerSettings } from '../model/MinerSettings';\nimport type { MinerStats } from '../model/MinerStats';\nimport { MinerFeatureKey } from '../model/MinerFeature';\nimport { sendSocketCommand } from '../../utils/socket-utils';\n\n// based on cgminer, but with different commands\n// TODO: inherit?\n\n// old braains api (pre grpc): https://academy.braiins.com/en/braiins-os/papi-bosminer/\nenum BOSMinerCommand {\n    stats = 'summary+coin',\n\n    // BOS only commands\n    pause = 'pause',\n    resume = 'resume',\n}\n\n/**\n *\n */\nexport class BOSMiner extends PollingMiner<BOSMinerSettings> {\n    /**\n     *\n     */\n    public override async start(): Promise<void> {\n        await this.sendCommand(BOSMinerCommand.resume, '', false);\n    }\n\n    /**\n     *\n     */\n    public override async fetchStats(): Promise<MinerStats> {\n        try {\n            const response = await this.sendCommand<object>(BOSMinerCommand.stats, '', true);\n            // TODO: parse response => actually return stats\n\n            return {\n                raw: response,\n            };\n        } catch (e) {\n            // forward error\n            return Promise.reject(e instanceof Error ? e : new Error(String(e)));\n        }\n    }\n\n    /**\n     *\n     */\n    public override async stop(): Promise<void> {\n        await this.sendCommand(BOSMinerCommand.pause, '', false);\n    }\n\n    /**\n     *\n     */\n    public override getSupportedFeatures(): MinerFeatureKey[] {\n        return [MinerFeatureKey.running, MinerFeatureKey.rawStats];\n    }\n\n    /**\n     *\n     */\n    public override getLoggerName(): string {\n        return `${super.getLoggerName()}BOSMiner[${this.settings.host}:${this.settings.port}]`;\n    }\n\n    /**\n     *\n     */\n    public override getCliArgs(): string[] {\n        return [];\n    }\n\n    private async sendCommand<T = void>(\n        command: BOSMinerCommand,\n        parameter: string = '',\n        expectResponse: boolean = true,\n    ): Promise<T> {\n        return sendSocketCommand(\n            this.logger,\n            this.settings.host,\n            this.settings.port,\n            {\n                command,\n                parameter,\n            },\n            expectResponse,\n        );\n    }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAA6B;AAG7B,0BAAgC;AAChC,0BAAkC;AAMlC,IAAK,kBAAL,kBAAKA,qBAAL;AACI,EAAAA,iBAAA,WAAQ;AAGR,EAAAA,iBAAA,WAAQ;AACR,EAAAA,iBAAA,YAAS;AALR,SAAAA;AAAA,GAAA;AAWE,MAAM,iBAAiB,iCAA+B;AAAA;AAAA;AAAA;AAAA,EAIzD,MAAsB,QAAuB;AACzC,UAAM,KAAK,YAAY,uBAAwB,IAAI,KAAK;AAAA,EAC5D;AAAA;AAAA;AAAA;AAAA,EAKA,MAAsB,aAAkC;AACpD,QAAI;AACA,YAAM,WAAW,MAAM,KAAK,YAAoB,4BAAuB,IAAI,IAAI;AAG/E,aAAO;AAAA,QACH,KAAK;AAAA,MACT;AAAA,IACJ,SAAS,GAAG;AAER,aAAO,QAAQ,OAAO,aAAa,QAAQ,IAAI,IAAI,MAAM,OAAO,CAAC,CAAC,CAAC;AAAA,IACvE;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAsB,OAAsB;AACxC,UAAM,KAAK,YAAY,qBAAuB,IAAI,KAAK;AAAA,EAC3D;AAAA;AAAA;AAAA;AAAA,EAKgB,uBAA0C;AACtD,WAAO,CAAC,oCAAgB,SAAS,oCAAgB,QAAQ;AAAA,EAC7D;AAAA;AAAA;AAAA;AAAA,EAKgB,gBAAwB;AACpC,WAAO,GAAG,MAAM,cAAc,CAAC,YAAY,KAAK,SAAS,IAAI,IAAI,KAAK,SAAS,IAAI;AAAA,EACvF;AAAA;AAAA;AAAA;AAAA,EAKgB,aAAuB;AACnC,WAAO,CAAC;AAAA,EACZ;AAAA,EAEA,MAAc,YACV,SACA,YAAoB,IACpB,iBAA0B,MAChB;AACV,eAAO;AAAA,MACH,KAAK;AAAA,MACL,KAAK,SAAS;AAAA,MACd,KAAK,SAAS;AAAA,MACd;AAAA,QACI;AAAA,QACA;AAAA,MACJ;AAAA,MACA;AAAA,IACJ;AAAA,EACJ;AACJ;",
  "names": ["BOSMinerCommand"]
}

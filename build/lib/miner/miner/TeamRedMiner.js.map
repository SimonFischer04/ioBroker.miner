{
  "version": 3,
  "sources": ["../../../../src/lib/miner/miner/TeamRedMiner.ts"],
  "sourcesContent": ["import { PollingMiner } from './PollingMiner';\nimport type { TeamRedMinerSettings } from '../model/MinerSettings';\nimport { ClaymoreMiner } from './ClaymoreMiner';\nimport { SGMiner } from './SGMiner';\nimport type { MinerStats } from '../model/MinerStats';\nimport type { MinerFeatureKey } from '../model/MinerFeature';\nimport { distinct } from '../../utils/array-utils';\n\n/**\n *\n */\nexport class TeamRedMiner extends PollingMiner<TeamRedMinerSettings> {\n    private readonly claymoreMiner: ClaymoreMiner;\n    private readonly sgMiner: SGMiner;\n\n    /**\n     *\n     */\n    constructor(settings: TeamRedMinerSettings) {\n        super(settings);\n\n        if (\n            settings.pollInterval !== settings.sg.pollInterval ||\n            settings.pollInterval !== settings.claymore.pollInterval\n        ) {\n            throw new Error('pollInterval must be the same for all miners');\n        }\n\n        this.claymoreMiner = new ClaymoreMiner(settings.claymore);\n        this.sgMiner = new SGMiner(settings.sg);\n    }\n\n    /**\n     *\n     */\n    public override async init(): Promise<void> {\n        await super.init();\n\n        // DO NOT CALL sub-miner.init() here, as it will init the polling interval, but trm is PollingMiner itself (own interval) => calls fetchData() for both miners itself and merges the results\n        // await this.claymoreMiner.init();\n        // await this.sgMiner.init();\n    }\n\n    /**\n     *\n     */\n    public override async start(): Promise<void> {\n        await this.claymoreMiner.start();\n    }\n\n    /**\n     *\n     */\n    public override async fetchStats(): Promise<MinerStats> {\n        const claymoreStats: MinerStats = await this.claymoreMiner.fetchStats();\n        const sgStats: MinerStats = await this.sgMiner.fetchStats();\n\n        return {\n            raw: {\n                claymore: claymoreStats.raw,\n                sg: sgStats.raw,\n            },\n            version: claymoreStats.version,\n            totalHashrate: claymoreStats.totalHashrate,\n        };\n    }\n\n    /**\n     *\n     */\n    public override async stop(): Promise<void> {\n        await this.claymoreMiner.stop();\n    }\n\n    /**\n     *\n     */\n    public override async close(): Promise<void> {\n        await this.claymoreMiner.close();\n    }\n\n    /**\n     *\n     */\n    public override getSupportedFeatures(): MinerFeatureKey[] {\n        return distinct([...this.claymoreMiner.getSupportedFeatures(), ...this.sgMiner.getSupportedFeatures()]);\n    }\n\n    /**\n     *\n     */\n    public override getCliArgs(): string[] {\n        return [...this.claymoreMiner.getCliArgs(), ...this.sgMiner.getCliArgs()];\n    }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAA6B;AAE7B,2BAA8B;AAC9B,qBAAwB;AAGxB,yBAAyB;AAKlB,MAAM,qBAAqB,iCAAmC;AAAA,EAChD;AAAA,EACA;AAAA;AAAA;AAAA;AAAA,EAKjB,YAAY,UAAgC;AACxC,UAAM,QAAQ;AAEd,QACI,SAAS,iBAAiB,SAAS,GAAG,gBACtC,SAAS,iBAAiB,SAAS,SAAS,cAC9C;AACE,YAAM,IAAI,MAAM,8CAA8C;AAAA,IAClE;AAEA,SAAK,gBAAgB,IAAI,mCAAc,SAAS,QAAQ;AACxD,SAAK,UAAU,IAAI,uBAAQ,SAAS,EAAE;AAAA,EAC1C;AAAA;AAAA;AAAA;AAAA,EAKA,MAAsB,OAAsB;AACxC,UAAM,MAAM,KAAK;AAAA,EAKrB;AAAA;AAAA;AAAA;AAAA,EAKA,MAAsB,QAAuB;AACzC,UAAM,KAAK,cAAc,MAAM;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAsB,aAAkC;AACpD,UAAM,gBAA4B,MAAM,KAAK,cAAc,WAAW;AACtE,UAAM,UAAsB,MAAM,KAAK,QAAQ,WAAW;AAE1D,WAAO;AAAA,MACH,KAAK;AAAA,QACD,UAAU,cAAc;AAAA,QACxB,IAAI,QAAQ;AAAA,MAChB;AAAA,MACA,SAAS,cAAc;AAAA,MACvB,eAAe,cAAc;AAAA,IACjC;AAAA,EACJ;AAAA;AAAA;AAAA;AAAA,EAKA,MAAsB,OAAsB;AACxC,UAAM,KAAK,cAAc,KAAK;AAAA,EAClC;AAAA;AAAA;AAAA;AAAA,EAKA,MAAsB,QAAuB;AACzC,UAAM,KAAK,cAAc,MAAM;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAKgB,uBAA0C;AACtD,eAAO,6BAAS,CAAC,GAAG,KAAK,cAAc,qBAAqB,GAAG,GAAG,KAAK,QAAQ,qBAAqB,CAAC,CAAC;AAAA,EAC1G;AAAA;AAAA;AAAA;AAAA,EAKgB,aAAuB;AACnC,WAAO,CAAC,GAAG,KAAK,cAAc,WAAW,GAAG,GAAG,KAAK,QAAQ,WAAW,CAAC;AAAA,EAC5E;AACJ;",
  "names": []
}

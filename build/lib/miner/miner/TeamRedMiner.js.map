{
  "version": 3,
  "sources": ["../../../../src/lib/miner/miner/TeamRedMiner.ts"],
  "sourcesContent": ["import {PollingMiner} from './PollingMiner';\nimport {TeamRedMinerSettings} from '../model/MinerSettings';\nimport {ClaymoreMiner} from './ClaymoreMiner';\nimport {SGMiner} from './SGMiner';\nimport {MinerStats} from '../model/MinerStats';\nimport {MinerFeatureKey} from '../model/MinerFeature';\nimport {distinct} from '../../utils/array-utils';\n\nexport class TeamRedMiner extends PollingMiner<TeamRedMinerSettings> {\n    private readonly claymoreMiner: ClaymoreMiner\n    private readonly sgMiner: SGMiner;\n\n    constructor(settings: TeamRedMinerSettings) {\n        super(settings);\n\n        if (settings.pollInterval !== settings.sg.pollInterval || settings.pollInterval !== settings.claymore.pollInterval) {\n            throw new Error('pollInterval must be the same for all miners');\n        }\n\n        this.claymoreMiner = new ClaymoreMiner(settings.claymore);\n        this.sgMiner = new SGMiner(settings.sg);\n    }\n\n    public override async init(): Promise<void> {\n        await super.init();\n\n        // DO NOT CALL sub-miner.init() here, as it will init the polling interval, but trm is PollingMiner itself (own interval) => calls fetchData() for both miners itself and merges the results\n        // await this.claymoreMiner.init();\n        // await this.sgMiner.init();\n    }\n\n    public override async start(): Promise<void> {\n        await this.claymoreMiner.start();\n    }\n\n    public override async fetchStats(): Promise<MinerStats> {\n        const claymoreStats: MinerStats = await this.claymoreMiner.fetchStats();\n        const sgStats: MinerStats = await this.sgMiner.fetchStats();\n\n        return {\n            version: claymoreStats.version,\n            totalHashrate: claymoreStats.totalHashrate,\n            raw: {\n                claymore: claymoreStats.raw,\n                sg: sgStats.raw\n            }\n        };\n    }\n\n    public override async stop(): Promise<void> {\n        await this.claymoreMiner.stop();\n    }\n\n    public override async close(): Promise<void> {\n        await this.claymoreMiner.close();\n    }\n\n    public getSupportedFeatures(): MinerFeatureKey[] {\n        return distinct([\n            ...this.claymoreMiner.getSupportedFeatures(),\n            ...this.sgMiner.getSupportedFeatures()\n        ]);\n    }\n\n    public getCliArgs(): string[] {\n        return [\n            ...this.claymoreMiner.getCliArgs(),\n            ...this.sgMiner.getCliArgs()\n        ]\n    }\n}"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAA2B;AAE3B,2BAA4B;AAC5B,qBAAsB;AAGtB,yBAAuB;AAEhB,MAAM,qBAAqB,iCAAmC;AAAA,EAChD;AAAA,EACA;AAAA,EAEjB,YAAY,UAAgC;AACxC,UAAM,QAAQ;AAEd,QAAI,SAAS,iBAAiB,SAAS,GAAG,gBAAgB,SAAS,iBAAiB,SAAS,SAAS,cAAc;AAChH,YAAM,IAAI,MAAM,8CAA8C;AAAA,IAClE;AAEA,SAAK,gBAAgB,IAAI,mCAAc,SAAS,QAAQ;AACxD,SAAK,UAAU,IAAI,uBAAQ,SAAS,EAAE;AAAA,EAC1C;AAAA,EAEA,MAAsB,OAAsB;AACxC,UAAM,MAAM,KAAK;AAAA,EAKrB;AAAA,EAEA,MAAsB,QAAuB;AACzC,UAAM,KAAK,cAAc,MAAM;AAAA,EACnC;AAAA,EAEA,MAAsB,aAAkC;AACpD,UAAM,gBAA4B,MAAM,KAAK,cAAc,WAAW;AACtE,UAAM,UAAsB,MAAM,KAAK,QAAQ,WAAW;AAE1D,WAAO;AAAA,MACH,SAAS,cAAc;AAAA,MACvB,eAAe,cAAc;AAAA,MAC7B,KAAK;AAAA,QACD,UAAU,cAAc;AAAA,QACxB,IAAI,QAAQ;AAAA,MAChB;AAAA,IACJ;AAAA,EACJ;AAAA,EAEA,MAAsB,OAAsB;AACxC,UAAM,KAAK,cAAc,KAAK;AAAA,EAClC;AAAA,EAEA,MAAsB,QAAuB;AACzC,UAAM,KAAK,cAAc,MAAM;AAAA,EACnC;AAAA,EAEO,uBAA0C;AAC7C,eAAO,6BAAS;AAAA,MACZ,GAAG,KAAK,cAAc,qBAAqB;AAAA,MAC3C,GAAG,KAAK,QAAQ,qBAAqB;AAAA,IACzC,CAAC;AAAA,EACL;AAAA,EAEO,aAAuB;AAC1B,WAAO;AAAA,MACH,GAAG,KAAK,cAAc,WAAW;AAAA,MACjC,GAAG,KAAK,QAAQ,WAAW;AAAA,IAC/B;AAAA,EACJ;AACJ;",
  "names": []
}

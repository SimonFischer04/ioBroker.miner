{
  "version": 3,
  "sources": ["../../../src/miner/model/IOBrokerMinerSettings.ts"],
  "sourcesContent": ["import type {\n    ClaymoreMinerSettings,\n    IceRiverOcMinerSettings,\n    MinerSettings,\n    TeamRedMinerSettings,\n    XMRigSettings,\n} from '../../lib/miner/model/MinerSettings';\nimport type { Category, categoryKeys } from '../../lib/miner/model/Category';\nimport { Logger } from '../../lib/miner/model/Logger';\n\nconst logger = Logger.getLogger('IOBrokerMinerSettings');\n\n/*\n    this adapter needs/stores more info per miner than is strictly required if just using the lib, so create su-types\n */\n\n// settings / native part of iobroker 'device'- objects\n/**\n *\n */\nexport interface IOBrokerDeviceSettings {\n    /**\n     *\n     */\n    category: Category;\n}\n\n/**\n *\n */\nexport interface IOBrokerMinerSettings extends IOBrokerDeviceSettings {\n    /**\n     *\n     */\n    category: (typeof categoryKeys)[0];\n    /**\n     *\n     */\n    name: string;\n    /**\n     *\n     */\n    mac: string; // used as object id\n\n    // adapter allows to temporarily disable handling a device (no connection created to the device, controls do nothing, ...)\n    // does not really make sense in a lib context, as then it is also possible to just not initialise the device\n    /**\n     *\n     */\n    enabled: boolean;\n\n    /**\n     *\n     */\n    settings: MinerSettings;\n}\n\n/**\n *\n */\nexport interface IOBrokerPoolSettings extends IOBrokerDeviceSettings {\n    /**\n     *\n     */\n    category: (typeof categoryKeys)[1];\n    // TODO\n}\n\n// TODO: check everywhere this is used\n/**\n *\n */\nexport function isMiner(settings?: Partial<IOBrokerDeviceSettings>): settings is IOBrokerMinerSettings {\n    return settings?.category === 'miner';\n}\n\n/**\n * Encrypt sensitive data in the settings\n *\n * @param settings - the settings to encrypt\n * @param encryptFunction - the function to encrypt a value\n */\nexport function encryptDeviceSettings(\n    settings: IOBrokerDeviceSettings,\n    encryptFunction: (value: string) => string,\n): IOBrokerDeviceSettings {\n    if (!isMiner(settings)) {\n        // TODO: pool support\n        logger.error(`category ${settings.category} is not yet supported.`);\n        return settings;\n    }\n\n    // TODO: cleaner way to do this?\n    switch (settings.settings.minerType) {\n        case 'teamRedMiner': {\n            const trmSettings = settings.settings as TeamRedMinerSettings;\n            trmSettings.claymore.password = encryptFunction(trmSettings.claymore.password);\n            break;\n        }\n\n        case 'claymoreMiner': {\n            const claymoreSettings = settings.settings as ClaymoreMinerSettings;\n            claymoreSettings.password = encryptFunction(claymoreSettings.password);\n            break;\n        }\n\n        case 'xmRig': {\n            const xmRigSettings = settings.settings as XMRigSettings;\n            xmRigSettings.password = encryptFunction(xmRigSettings.password);\n            break;\n        }\n\n        case 'iceRiverOcMiner': {\n            const iceRiverOcSettings = settings.settings as IceRiverOcMinerSettings;\n            iceRiverOcSettings.password = encryptFunction(iceRiverOcSettings.password);\n            break;\n        }\n\n        default: {\n            break;\n        }\n    }\n\n    return settings;\n}\n\n/**\n * Decrypt sensitive data in the settings\n *\n * @param settings - the settings to decrypt\n * @param decryptFunction - the function to decrypt a value\n */\nexport function decryptDeviceSettings(\n    settings: IOBrokerDeviceSettings,\n    decryptFunction: (value: string) => string,\n): IOBrokerDeviceSettings {\n    if (!isMiner(settings)) {\n        // TODO: pool support\n        logger.error(`category ${settings.category} is not yet supported.`);\n        return settings;\n    }\n\n    // TODO: cleaner way to do this?\n    switch (settings.settings.minerType) {\n        case 'teamRedMiner': {\n            const trmSettings = settings.settings as TeamRedMinerSettings;\n            trmSettings.claymore.password = decryptFunction(trmSettings.claymore.password);\n            break;\n        }\n\n        case 'claymoreMiner': {\n            const claymoreSettings = settings.settings as ClaymoreMinerSettings;\n            claymoreSettings.password = decryptFunction(claymoreSettings.password);\n            break;\n        }\n\n        case 'xmRig': {\n            const xmRigSettings = settings.settings as XMRigSettings;\n            xmRigSettings.password = decryptFunction(xmRigSettings.password);\n            break;\n        }\n\n        case 'iceRiverOcMiner': {\n            const iceRiverOcSettings = settings.settings as IceRiverOcMinerSettings;\n            iceRiverOcSettings.password = decryptFunction(iceRiverOcSettings.password);\n            break;\n        }\n\n        default: {\n            break;\n        }\n    }\n\n    return settings;\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA,oBAAuB;AAEvB,MAAM,SAAS,qBAAO,UAAU,uBAAuB;AA8DhD,SAAS,QAAQ,UAA+E;AACnG,UAAO,qCAAU,cAAa;AAClC;AAQO,SAAS,sBACZ,UACA,iBACsB;AACtB,MAAI,CAAC,QAAQ,QAAQ,GAAG;AAEpB,WAAO,MAAM,YAAY,SAAS,QAAQ,wBAAwB;AAClE,WAAO;AAAA,EACX;AAGA,UAAQ,SAAS,SAAS,WAAW;AAAA,IACjC,KAAK,gBAAgB;AACjB,YAAM,cAAc,SAAS;AAC7B,kBAAY,SAAS,WAAW,gBAAgB,YAAY,SAAS,QAAQ;AAC7E;AAAA,IACJ;AAAA,IAEA,KAAK,iBAAiB;AAClB,YAAM,mBAAmB,SAAS;AAClC,uBAAiB,WAAW,gBAAgB,iBAAiB,QAAQ;AACrE;AAAA,IACJ;AAAA,IAEA,KAAK,SAAS;AACV,YAAM,gBAAgB,SAAS;AAC/B,oBAAc,WAAW,gBAAgB,cAAc,QAAQ;AAC/D;AAAA,IACJ;AAAA,IAEA,KAAK,mBAAmB;AACpB,YAAM,qBAAqB,SAAS;AACpC,yBAAmB,WAAW,gBAAgB,mBAAmB,QAAQ;AACzE;AAAA,IACJ;AAAA,IAEA,SAAS;AACL;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AACX;AAQO,SAAS,sBACZ,UACA,iBACsB;AACtB,MAAI,CAAC,QAAQ,QAAQ,GAAG;AAEpB,WAAO,MAAM,YAAY,SAAS,QAAQ,wBAAwB;AAClE,WAAO;AAAA,EACX;AAGA,UAAQ,SAAS,SAAS,WAAW;AAAA,IACjC,KAAK,gBAAgB;AACjB,YAAM,cAAc,SAAS;AAC7B,kBAAY,SAAS,WAAW,gBAAgB,YAAY,SAAS,QAAQ;AAC7E;AAAA,IACJ;AAAA,IAEA,KAAK,iBAAiB;AAClB,YAAM,mBAAmB,SAAS;AAClC,uBAAiB,WAAW,gBAAgB,iBAAiB,QAAQ;AACrE;AAAA,IACJ;AAAA,IAEA,KAAK,SAAS;AACV,YAAM,gBAAgB,SAAS;AAC/B,oBAAc,WAAW,gBAAgB,cAAc,QAAQ;AAC/D;AAAA,IACJ;AAAA,IAEA,KAAK,mBAAmB;AACpB,YAAM,qBAAqB,SAAS;AACpC,yBAAmB,WAAW,gBAAgB,mBAAmB,QAAQ;AACzE;AAAA,IACJ;AAAA,IAEA,SAAS;AACL;AAAA,IACJ;AAAA,EACJ;AAEA,SAAO;AACX;",
  "names": []
}
